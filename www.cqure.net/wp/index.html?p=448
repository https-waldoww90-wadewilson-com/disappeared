<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>cqure.net  &raquo; Blog Archive   &raquo; Using Nmap for pentesting eDirectory</title>

<meta name="generator" content="WordPress 3.4.1" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/cqure2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="feed/rss/index.html" />
<link rel="alternate" type="text/xml" title="RSS .92" href="feed/rss/index.html" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="feed/atom/index.html" />
<link rel="pingback" href="xmlrpc.php" />

	<link rel='archives' title='July 2012' href='2012/07/index.html' />
	<link rel='archives' title='May 2012' href='2012/05/index.html' />
	<link rel='archives' title='August 2011' href='2011/08/index.html' />
	<link rel='archives' title='June 2011' href='2011/06/index.html' />
	<link rel='archives' title='February 2011' href='2011/02/index.html' />
	<link rel='archives' title='January 2011' href='2011/01/index.html' />
	<link rel='archives' title='August 2010' href='2010/08/index.html' />
	<link rel='archives' title='May 2010' href='2010/05/index.html' />
	<link rel='archives' title='March 2010' href='2010/03/index.html' />
	<link rel='archives' title='February 2010' href='2010/02/index.html' />
	<link rel='archives' title='January 2010' href='2010/01/index.html' />
	<link rel='archives' title='December 2009' href='2009/12/index.html' />
	<link rel='archives' title='November 2009' href='2009/11/index.html' />
	<link rel='archives' title='October 2009' href='2009/10/index.html' />
	<link rel='archives' title='September 2009' href='2009/09/index.html' />
	<link rel='archives' title='May 2009' href='2009/05/index.html' />
	<link rel='archives' title='September 2008' href='2008/09/index.html' />
	<link rel='archives' title='August 2008' href='2008/08/index.html' />
	<link rel='archives' title='May 2008' href='2008/05/index.html' />
	<link rel='archives' title='April 2008' href='2008/04/index.html' />
	<link rel='archives' title='November 2007' href='2007/11/index.html' />
	<link rel='archives' title='October 2007' href='2007/10/index.html' />
	<link rel='archives' title='September 2007' href='2007/09/index.html' />
	<link rel='archives' title='August 2007' href='2007/08/index.html' />
	<link rel='archives' title='July 2007' href='2007/07/index.html' />
	<link rel='archives' title='March 2007' href='2007/03/index.html' />
	<link rel='archives' title='February 2007' href='2007/02/index.html' />
	<link rel='archives' title='January 2007' href='2007/01/index.html' />
	<link rel='archives' title='November 2006' href='2006/11/index.html' />
	<link rel='archives' title='October 2006' href='2006/10/index.html' />
	<link rel='archives' title='March 2006' href='2006/03/index.html' />
	<link rel='archives' title='February 2006' href='2006/02/index.html' />
	<link rel='archives' title='January 2006' href='2006/01/index.html' />

<link rel="alternate" type="application/rss+xml" title="cqure.net &raquo; Using Nmap for pentesting eDirectory Comments Feed" href="2011/06/using-nmap-for-pentesting-edirectory/feed/index.html" />
<link rel='stylesheet' id='A2A_SHARE_SAVE-css'  href='wp-content/plugins/add-to-any/addtoany.min.css?ver=1.4' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js?ver=3.4.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Using Nmap to audit your MySQL database' href='2011/06/using-nmap-to-audit-your-mysql-database/trackback/index.html' />
<link rel='next' title='I&#8217;ve ported mbenum to Nmap' href='2011/08/ive-ported-mbenum-to-nmap/trackback/index.html' />
<link rel='canonical' href='2011/06/using-nmap-for-pentesting-edirectory/trackback/index.html' />
<link rel='shortlink' href='index.html?p=448' />

<script type="text/javascript"><!--
var a2a_config=a2a_config||{},wpa2a={done:false,html_done:false,script_ready:false,script_load:function(){var a=document.createElement('script'),s=document.getElementsByTagName('script')[0];a.type='text/javascript';a.async=true;a.src='http://static.addtoany.com/menu/page.js';s.parentNode.insertBefore(a,s);wpa2a.script_load=function(){};},script_onready:function(){if(a2a.type=='page'){wpa2a.script_ready=true;if(wpa2a.html_done)wpa2a.init();}},init:function(){for(var i=0,el,target,targets=wpa2a.targets,length=targets.length;i<length;i++){el=document.getElementById('wpa2a_'+(i+1));target=targets[i];a2a_config.linkname=target.title;a2a_config.linkurl=target.url;if(el)a2a.init('page',{target:el});wpa2a.done=true;}}};a2a_config.tracking_callback=['ready',wpa2a.script_onready];
//--></script>
<script type="text/javascript">
	swfobject.registerObject("wpFollowmeFlash", "9.0.0");
</script>
<style type="text/css">
	.getflash { font-size:8px; }
	.wp_followme_c2 {
		position:fixed;
		background:#59B7FF;
		top:200px;
		right:0px;
		width:32px;
		height:160px;
		border:1px solid #FFFFFF;
		color:#FFFFFF;
	}
</style>

<!--[if IE]>
<style type="text/css">
.addtoany_list a img{filter:alpha(opacity=70)}
.addtoany_list a:hover img,.addtoany_list a.addtoany_share_save img{filter:alpha(opacity=100)}
</style>
<![endif]-->
</head>
<body background="wp-content/themes/cqure2/images/eye.jpg">

<div class="title"><a href="../wp.1">cqure.net</a></div>
<div class="description"></div>
<div id="page">
<br>
<div class="top-ad">
<script type="text/javascript"><!--
google_ad_client = "pub-5587712415782238";
//Link unit below logo 728x15
google_ad_slot = "9173520977";
google_ad_width = 728;
google_ad_height = 15;
//--></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<!-- Start Obar -->

	<div class="obar">
<ul>

<script type="text/javascript"><!--
google_ad_client = "pub-5587712415782238";
//120x600, created 11/8/07
google_ad_slot = "9346871999";
google_ad_width = 120;
google_ad_height = 600;
//--></script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</ul>
	</div>

<!-- End Obar -->

	<div id="content" class="widecolumn">
				
  	
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="2011/06/using-nmap-to-audit-your-mysql-database/trackback/index.html" rel="prev">Using Nmap to audit your MySQL database</a></div>
			<div class="alignright"><a href="2011/08/ive-ported-mbenum-to-nmap/trackback/index.html" rel="next">I&#8217;ve ported mbenum to Nmap</a> &raquo;</div>
		</div>
	
		<div class="post" id="post-448">
			<h2><a href="2011/06/using-nmap-for-pentesting-edirectory/trackback/index.html" rel="bookmark" title="Permanent Link: Using Nmap for pentesting eDirectory">Using Nmap for pentesting eDirectory</a></h2>
	
			<div class="entrytext">
				<p>While doing a security review the other day I came across Novell eDirectory running on Windows. It&#8217;s been a while since I looked at eDirectory and while it&#8217;s a lot of LDAP, the servers were also running the Netware Core Protocol (NCP). I noticed that there wasn&#8217;t any NCP support in Nmap so I decided that I would implement some basic support. I ended up writing a NCP library and the following two scripts:</p>
<ul>
<li>ncp-enum-users &#8211; enumerates eDirectory users</li>
<li>ncp-serverinfo &#8211; lists some basic server information</li>
</ul>
<p>The scripts should work against NCP running on both Netware, Linux and Windows. Here&#8217;s some sample output from both scripts:</p>
<pre>| ncp-serverinfo:
|   Server name: LINUX-L84T
|   Tree Name: CQURE-TREE
|   OS Version: 5.70 (rev 7)
|   Product version: 6.50 (rev 7)
|   OS Language ID: 4
|   Addresses
|     10.0.200.33 524/udp
|     10.0.200.33 524/tcp
|   Mounts
|     SYS
|     ADMIN
|_    _ADMIN</pre>
<pre>| ncp-enum-users:
|   CN=admin.O=cqure
|   CN=cawi.OU=finance.O=cqure
|   CN=linux-l84tadmin.O=cqure
|   CN=nist.OU=hr.O=cqure
|   CN=novlxregd.O=cqure
|   CN=novlxsrvd.O=cqure
|   CN=OESCommonProxy_linux-l84t.O=cqure
|   CN=sasi.OU=hr.O=cqure
|_  CN=wwwrun.O=cqure</pre>
<p>In addition to the NCP scripts I wrote a LDAP script (ldap-novell-getpass) that extract the plain-text password of a given user, in case the &#8220;Allow admin to retrieve passwords&#8221; option is enabled in the password policy. On success, the script returns the following result:</p>
<pre>| ldap-novell-getpass:
|   Account: CN=patrik,OU=security,O=cqure
|_  Password: foobar</pre>
<p>All of the scripts have been committed to Nmap and are available through subversion.</p>
<div class="addtoany_share_save_container"><div class="a2a_kit a2a_target addtoany_list" id="wpa2a_1"><a class="a2a_dd addtoany_share_save" href="http://www.addtoany.com/share_save"><img src="wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></div>
<script type="text/javascript"><!--
wpa2a.script_load();
//--></script>
</div>	
					
				<p class="postmetadata alt">
					<small>
						This entry was posted
						 
						on Sunday, June 5th, 2011 at 3:52 pm						and is filed under <a href="category/nmap-2/index.html" title="View all posts in Nmap" rel="category tag">Nmap</a>.
						You can follow any responses to this entry through the <a href='2011/06/using-nmap-for-pentesting-edirectory/feed/index.html'>RSS 2.0</a> feed. 
						
													You can <a href="2011/06/using-nmap-for-pentesting-edirectory/trackback/index.html#respond">leave a response</a>, or <a href="2011/06/using-nmap-for-pentesting-edirectory/trackback/index.html" rel="trackback">trackback</a> from your own site.
						
												
					</small>
				</p>
	
			</div>
		</div>
		
	
<!-- You can start editing here. -->


   
		<!-- If comments are open, but there are no comments. -->
		
	 


<h3 id="respond">Leave a Reply</h3>

<p>You must be <a href="http://www.cqure.net/wp/wp-login.php?redirect_to=http://www.cqure.net/wp/2011/06/using-nmap-for-pentesting-edirectory/">logged in</a> to post a comment.</p>

	
		
	</div>


<hr />
<div id="footer">
	<p>
		cqure.net is proudly powered by 
		<a href="http://wordpress.org">WordPress</a>
		<br /><a href="feed:http://www.cqure.net/wp/feed/">Entries (RSS)</a>
		and <a href="feed:http://www.cqure.net/wp/comments/feed/">Comments (RSS)</a>.
		<!-- 16 queries. 2.959 seconds. -->
	</p>
</div>
</div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		
<script type="text/javascript"><!--
wpa2a.targets=[
{title:'Using Nmap for pentesting eDirectory',url:'http://www.cqure.net/wp/2011/06/using-nmap-for-pentesting-edirectory/'}];
wpa2a.html_done=true;if(wpa2a.script_ready&&!wpa2a.done)wpa2a.init();wpa2a.script_load();
//--></script>

<div style="position:relative;">
	<div class="wp_followme_c2">
		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="32" height="160" id="wpFollowmeFlash">
			<param name="movie" value="http://www.cqure.net/wp/wp-content/plugins/wp-followme/flash/wp_followme.swf" />
			<param name="allowfullscreen" value="false" />
			<param name="allowscriptaccess" value="always" />
			<param name="flashvars" value="twit_icon=http://www.cqure.net/wp/wp-content/plugins/wp-followme/icons/1.png&amp;turl=http://twitter.com/nevdull77&amp;twitmsg=Follow Me&amp;twitmsgcolor=FFFFFF&amp;iconbgcolor=FFFFFF" />
			<param name="bgcolor" value="#59B7FF" />
			<!--[if !IE]>-->
			<object type="application/x-shockwave-flash" data="wp-content/plugins/wp-followme/flash/wp_followme.swf" width="32" height="160">
				<param name="allowfullscreen" value="false" />
				<param name="allowscriptaccess" value="always" />
				<param name="flashvars" value="twit_icon=http://www.cqure.net/wp/wp-content/plugins/wp-followme/icons/1.png&amp;turl=http://twitter.com/nevdull77&amp;twitmsg=Follow Me&amp;twitmsgcolor=FFFFFF&amp;iconbgcolor=FFFFFF" />
				<param name="bgcolor" value="#59B7FF" />
				<!--<![endif]-->
				<div class="getflash">
					<a rel="nofollow" href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" /></a>
									</div><!--[if !IE]>-->
			</object> <!--<![endif]-->
		</object>
	</div>
</div>


<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-3096101-2";
urchinTracker();
</script>

</body>
</html>
