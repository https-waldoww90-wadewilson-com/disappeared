<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>cqure.net &#187; Patrik Karlsson</title>
	<atom:link href="http://www.cqure.net/wp/author/patrik-karlsson/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.cqure.net/wp</link>
	<description></description>
	<lastBuildDate>Thu, 19 Jul 2012 12:36:51 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=</generator>
		<item>
		<title>Pulling Cisco configs with Nmap</title>
		<link>http://www.cqure.net/wp/2011/02/pulling-cisco-configs-with-nmap/</link>
		<comments>http://www.cqure.net/wp/2011/02/pulling-cisco-configs-with-nmap/#comments</comments>
		<pubDate>Tue, 22 Feb 2011 19:16:55 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[Nmap]]></category>
		<category><![CDATA[cisco]]></category>
		<category><![CDATA[configuration]]></category>
		<category><![CDATA[ios]]></category>
		<category><![CDATA[lua]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[script]]></category>
		<category><![CDATA[snmp]]></category>
		<category><![CDATA[tftp]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=433</guid>
		<description><![CDATA[A few hours ago I committed a new script created by Vikas Singhal to Nmap. It implements the functionality to initiate a tftp transfer of a Cisco configuration through SNMP. In order to do so, the device obviously needs to support this functionality, and you need to know the private SNMP-community string. The script can [...]]]></description>
			<content:encoded><![CDATA[<p>A few hours ago I committed a new script created by Vikas Singhal to Nmap. It implements the functionality to initiate a tftp transfer of a Cisco configuration through SNMP. In order to do so, the device obviously needs to support this functionality, and you need to know the private SNMP-community string.</p>
<p>The script can either save the configuration to a file in a directory specified as a script argument or displays it on screen. In order to achieve this, I&#8217;ve contributed with a minimal tftp server, implemented as a Nmap NSE library. This eliminates the need to setup and configure a separate tftp-server as it&#8217;s all being taken care of transparently by Nmap.</p>
<p>In order to try it out you can either update from subversion or download the <a href="http://nmap.org/svn/nselib/tftp.lua">tftp</a> library and the <a href="http://nmap.org/svn/scripts/snmp-ios-config.nse">snmp-ios-config</a> script and place them in nselib and the scripts directory. For more information on how to run the script, check out the <a href="http://nmap.org/nsedoc/scripts/snmp-ios-config.html">documentation</a>.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2011%2F02%2Fpulling-cisco-configs-with-nmap%2F&amp;title=Pulling%20Cisco%20configs%20with%20Nmap" id="wpa2a_2"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2011/02/pulling-cisco-configs-with-nmap/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Nmap mssql scripts feature boost</title>
		<link>http://www.cqure.net/wp/2011/02/nmap-mssql-scripts-feature-boost/</link>
		<comments>http://www.cqure.net/wp/2011/02/nmap-mssql-scripts-feature-boost/#comments</comments>
		<pubDate>Tue, 22 Feb 2011 18:52:03 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[Nmap]]></category>
		<category><![CDATA[lua]]></category>
		<category><![CDATA[microsoft sql server]]></category>
		<category><![CDATA[ms sql]]></category>
		<category><![CDATA[mssql]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[ntlm]]></category>
		<category><![CDATA[script]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=429</guid>
		<description><![CDATA[Chris Woodbury and I have been working on some new exciting features and enhancements to the ms-sql scripts and library in Nmap lately. We&#8217;ve been working in a separate branch which will hopefully get merged to trunk really soon. Chris work has been of high quality and very inspiring! It got me to pick up [...]]]></description>
			<content:encoded><![CDATA[<p>Chris Woodbury and I have been working on some new exciting features and enhancements to the ms-sql scripts and library in Nmap lately. We&#8217;ve been working in a separate branch which will hopefully get merged to trunk really soon. Chris work has been of high quality and very inspiring! It got me to pick up some of the stuff I meant to implement, but hadn&#8217;t got to, and has brought a number of new great ideas. For a good summary of changes consult the following nmap-dev mailing list <a href="http://seclists.org/nmap-dev/2011/q1/505">thread</a>.</p>
<p>Among the many new features and enhancements I&#8217;m really happy to see are:</p>
<ul>
<li>Support for more precise version checking, by using the prelogin packet (same technique as SQLPing)</li>
<li>Support for connections using named pipes, rather than tcp-sockets</li>
<li>Support for integrated authentication (Ntlmv1) in addition to the existing SQL authentication</li>
<li>Support for connecting to named instances in addition to specific tcp ports</li>
<li>Support for running each of the ms-sql scripts against all instances detected by the discovery mechanisms</li>
</ul>
<p>If you would like to give the scripts a run they&#8217;re available from <a href="svn://svn.insecure.org/nmap-exp/patrik/nmap-mssql">here</a>, and will hopefully be merged to trunk really soon.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2011%2F02%2Fnmap-mssql-scripts-feature-boost%2F&amp;title=Nmap%20mssql%20scripts%20feature%20boost" id="wpa2a_4"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2011/02/nmap-mssql-scripts-feature-boost/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>15 new nmap scripts</title>
		<link>http://www.cqure.net/wp/2010/08/15-new-nmap-scripts/</link>
		<comments>http://www.cqure.net/wp/2010/08/15-new-nmap-scripts/#comments</comments>
		<pubDate>Sun, 08 Aug 2010 17:27:46 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[cqure.net]]></category>
		<category><![CDATA[tools]]></category>
		<category><![CDATA[bug]]></category>
		<category><![CDATA[cve]]></category>
		<category><![CDATA[domino]]></category>
		<category><![CDATA[encryption]]></category>
		<category><![CDATA[guessing]]></category>
		<category><![CDATA[ibm]]></category>
		<category><![CDATA[informix]]></category>
		<category><![CDATA[lotus]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[oracle]]></category>
		<category><![CDATA[password]]></category>
		<category><![CDATA[query]]></category>
		<category><![CDATA[scan]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[server]]></category>
		<category><![CDATA[sql]]></category>
		<category><![CDATA[tns]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=417</guid>
		<description><![CDATA[I just posted 15 new nmap scripts to the nmap-dev mailing list. For anyone curios to check them out have a look over here. I&#8217;ve been working on these new scripts for a while and they add yet more database support to nmap allowing users to perform password guessing against both Oracle and Informix servers. [...]]]></description>
			<content:encoded><![CDATA[<p>I just posted 15 new nmap scripts to the nmap-dev mailing list. For anyone curios to check them out have a look over <a href="http://seclists.org/nmap-dev/2010/q3/284">here</a>. I&#8217;ve been working on these new scripts for a while and they add yet more database support to nmap allowing users to perform password guessing against both Oracle and Informix servers. In addition custom SQL queries can be made to Informix servers directly from nmap.</p>
<p>I&#8217;ve also created a number of scripts which can be suitable when pen testing Lotus Domino. These scripts include support for collecting Internet password hashes and user ID files. ID files can be collected both as an authenticated user from the person web view or unauthenticated using the vulnerability <a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2006-5835">CVE-2006-5835</a>. Oh, and you can add Lotus Domino 8.5 to the list of vulnerable versions in that advisory. There are also two scripts that allow you to interact with the IBM Lotus Domino remote console. One script allows for password guessing, while the other one allows you to interact with the console ones your authenticated.</p>
<p>There&#8217;s a tiny script in the zip file that supports querying for registered objects in a ORB Naming Service using the GIOP protocol.</p>
<p>Last but not least I&#8217;ve created a framework for other password guessing scripts to use. The framework runs using multiple worker threads and does all the looping, iteration and other basic logic used by most of my previous brute scripts.</p>
<p>The zip file included in the nmap-dev post can be downloaded from <a href="http://www.cqure.net/files/nmap_nse_20100808.zip">here</a>. Please help me out testing the scripts so that they can be added to the subversion version of nmap!</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F08%2F15-new-nmap-scripts%2F&amp;title=15%20new%20nmap%20scripts" id="wpa2a_6"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/08/15-new-nmap-scripts/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Updated rdesktop patch</title>
		<link>http://www.cqure.net/wp/2010/05/updated-rdesktop-patch/</link>
		<comments>http://www.cqure.net/wp/2010/05/updated-rdesktop-patch/#comments</comments>
		<pubDate>Sun, 09 May 2010 07:37:19 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[brute]]></category>
		<category><![CDATA[grinding]]></category>
		<category><![CDATA[guessing]]></category>
		<category><![CDATA[password]]></category>
		<category><![CDATA[patch]]></category>
		<category><![CDATA[rdesktop]]></category>
		<category><![CDATA[rdp]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=412</guid>
		<description><![CDATA[I&#8217;ve got an e-mail from someone who had trouble with my old rdesktop password guessing patch. So, I took a new look at it and updated it to do more than just dump core It&#8217;s available for download from the rdesktop page.]]></description>
			<content:encoded><![CDATA[<p>I&#8217;ve got an e-mail from someone who had trouble with my old rdesktop password guessing patch. So, I took a new look at it and updated it to do more than just dump core <img src='http://www.cqure.net/wp/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> </p>
<p>It&#8217;s available for download from the rdesktop <a href="http://www.cqure.net/wp/rdesktop-patches/">page</a>.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F05%2Fupdated-rdesktop-patch%2F&amp;title=Updated%20rdesktop%20patch" id="wpa2a_8"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/05/updated-rdesktop-patch/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Detecting Apple Mac OS X AFP vulnerability CVE-2010-0533 with Nmap</title>
		<link>http://www.cqure.net/wp/2010/03/detecting-apple-mac-os-x-afp-vulnerability-cve-2010-0533-with-nmap/</link>
		<comments>http://www.cqure.net/wp/2010/03/detecting-apple-mac-os-x-afp-vulnerability-cve-2010-0533-with-nmap/#comments</comments>
		<pubDate>Mon, 29 Mar 2010 17:53:56 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[tools]]></category>
		<category><![CDATA[10.6.3]]></category>
		<category><![CDATA[afp]]></category>
		<category><![CDATA[apple]]></category>
		<category><![CDATA[attack]]></category>
		<category><![CDATA[cve-2010-0533]]></category>
		<category><![CDATA[exploit]]></category>
		<category><![CDATA[hack]]></category>
		<category><![CDATA[lua]]></category>
		<category><![CDATA[mac]]></category>
		<category><![CDATA[macintosh]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[openssl]]></category>
		<category><![CDATA[os x]]></category>
		<category><![CDATA[ports]]></category>
		<category><![CDATA[portscanner]]></category>
		<category><![CDATA[remote]]></category>
		<category><![CDATA[scan]]></category>
		<category><![CDATA[snow leopard]]></category>
		<category><![CDATA[vulnerability]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=359</guid>
		<description><![CDATA[During the development of my AFP library for Nmap I came a cross a critical vulnerability in Apple&#8217;s implementation of AFP on Snow Leopard. The vulnerability occurs due to improper input validation and allows an attacker to access (list, read, and/or write) files in the parent directory of any AFP sharepoint. By default, when enabling [...]]]></description>
			<content:encoded><![CDATA[<p>During the development of my AFP library for <a href="http://nmap.org">Nmap</a> I came a cross a critical vulnerability in Apple&#8217;s implementation of AFP on Snow Leopard. The vulnerability occurs due to improper input validation and allows an attacker to access (list, read, and/or write) files in the parent directory of any AFP sharepoint.</p>
<p><span id="more-359"></span>By default, when enabling AFP, the Public folder in each user&#8217;s home directory is shared as &lt;Usernames&gt; Public Folder. In my case &#8220;Patrik Karlsson&#8217;s Public Folder&#8221;. Since the Public folder is a subdirectory of a user&#8217;s home directory, exploiting this share provides access to all of that user&#8217;s home directory files (but not subdirectories or files with restrictive filesystem permissions).</p>
<p>As the name suggests, the Public shares are available to anyone without authentication. Given the default permissions on home directories (world read+execute) and the default umask (world read), this has a serious impact &#8211; as unauthenticated users can read all files in a user&#8217;s home directory. The attack also works for authenticated users against shares requiring authentication.</p>
<p>Technically the attack is not very challenging and relies on a classic directory traversal attack. It is strikingly similar to the famous Windows SMB filesharing <a href="http://seclists.org/bugtraq/1995/Jul/77">vulnerability</a> from 1995. However, sending such a path to the server without interpreting and translating it on the client is somewhat more challenging. I&#8217;ve developed a number of different scripts while researching the vulnerability that list, read and write files in the parent directory. In order to do so I&#8217;ve added the necessary code to the AFP library which is essentially the core of these NSE scripts.</p>
<p>At this time I&#8217;m releasing two scripts <a href="http://nmap.org/nsedoc/scripts/afp-path-vuln.html">afp-path-vuln</a>, <a href="http://nmap.org/nsedoc/scripts/afp-brute.html">afp-brute</a> and library. The vulnerability detection script attempts to determine whether the scanned servers are vulnerable or not and outputs the contents of the parent directory if they are. The script and library are as of now available from the latest <a href="http://nmap.org/book/install.html#inst-svn">subversion version of Nmap</a> and can also be downloaded here:</p>
<p><a href="http://nmap.org/svn/scripts/afp-path-vuln.nse">http://nmap.org/svn/scripts/afp-path-vuln.nse</a><br />
<a href="http://nmap.org/svn/scripts/afp-brute.nse">http://nmap.org/svn/scripts/afp-brute.nse</a><br />
<a href="http://nmap.org/svn/nselib/afp.lua">http://nmap.org/svn/nselib/afp.lua</a></p>
<p>You can run the scripts either from your current version of Nmap or from the current subversion release. If you want to run the script with user credentials it needs the subversion release of Nmap as adding the support for AFP authentication involved patching the LUA to OpenSSL API.</p>
<p>For documentation on how to add scripts to your current Nmap installation have a look at Ron Bowes blog post &#8220;How-to: install an Nmap script&#8221; over <a href="http://www.skullsecurity.org/blog/?p=459">here</a>. The afp.lua library should be copied to the nselib directory which is located in the same parent directory as the scripts directory described in the blog post.</p>
<p>Last, but not least, here is the syntax for running the scripts against a system or network to detect vulnerable hosts:</p>
<pre lang="bash">nmap -p 548 --script afp-path-vuln &lt;host or network&gt;</pre>
<p>If the server is vulnerable it will show the following output:</p>
<p>PORT    STATE SERVICE<br />
548/tcp open  afp<br />
| afp-path-vuln:<br />
|   Patrik&#8217;s Public Folder/../ (5 first items)<br />
|     .bash_history<br />
|     .bash_profile<br />
|     .CFUserTextEncoding<br />
|     .config/<br />
|     .crash_report_checksum<br />
|<br />
|_AFP path traversal (CVE-2010-0533): VULNERABLE</p>
<p><span style="text-decoration: underline;">Solution</span><br />
Apple has released Mac OS X 10.6.3 which addresses the vulnerability. It can be downloaded from here:<br />
<a href="http://support.apple.com/kb/HT1222">http://support.apple.com/kb/HT1222</a></p>
<p><span style="text-decoration: underline;">Credits</span><br />
Thanks to Fyodor and David Fifield for great suggestions, moral support, and review of the code.</p>
<p><span style="text-decoration: underline;">Timeline</span><br />
2010-02-10 &#8211; Security vulnerability disclosed to Apple together with PoC<br />
2010-02-10 &#8211; Apple responds and have been able to reproduce vulnerability<br />
2010-02-15 &#8211; Request of status update<br />
2010-02-18 &#8211; Request of status update<br />
2010-02-22 &#8211; Request of status update<br />
2010-02-22 &#8211; Apple responds with DRAFT advisory and timing for disclosure (week starting 02/28)<br />
2010-03-06 &#8211; Disclosure date overdue, request for status update<br />
2010-03-08 &#8211; Apple responds with a new date for disclosure (week starting 03/15)<br />
2010-03-17 &#8211; Request status update<br />
2010-03-17 &#8211; Apple responds with a new date for disclosure (week starting 03/23)<br />
2010-03-17 &#8211; Apple corrects the disclosure date to the 29th of March</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F03%2Fdetecting-apple-mac-os-x-afp-vulnerability-cve-2010-0533-with-nmap%2F&amp;title=Detecting%20Apple%20Mac%20OS%20X%20AFP%20vulnerability%20CVE-2010-0533%20with%20Nmap" id="wpa2a_10"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/03/detecting-apple-mac-os-x-afp-vulnerability-cve-2010-0533-with-nmap/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Nmap-scripts cleanup</title>
		<link>http://www.cqure.net/wp/2010/02/nmap-scripts-cleanup/</link>
		<comments>http://www.cqure.net/wp/2010/02/nmap-scripts-cleanup/#comments</comments>
		<pubDate>Wed, 17 Feb 2010 11:36:39 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[tools]]></category>
		<category><![CDATA[cleanup]]></category>
		<category><![CDATA[commit]]></category>
		<category><![CDATA[cracking]]></category>
		<category><![CDATA[discovery]]></category>
		<category><![CDATA[fin]]></category>
		<category><![CDATA[hacking]]></category>
		<category><![CDATA[lua]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[packet]]></category>
		<category><![CDATA[scanner]]></category>
		<category><![CDATA[scanning]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[subversion]]></category>
		<category><![CDATA[syn]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=354</guid>
		<description><![CDATA[I&#8217;ve cleaned up the Nmap scripts page a bit to better reflect reality. Most of the scripts published on that page have been commited to the Nmap development release. I&#8217;m actively working on getting the remainder commited to. Once the scripts have been commited, they&#8217;re no longer maintained here. So, in order to try them [...]]]></description>
			<content:encoded><![CDATA[<p>I&#8217;ve cleaned up the Nmap scripts page a bit to better reflect reality. Most of the scripts published on that page have been commited to the Nmap development release. I&#8217;m actively working on getting the remainder commited to. Once the scripts have been commited, they&#8217;re no longer maintained here. So, in order to try them out I recommend you to install the latest development release of Nmap. In order to do so, follow the steps outlined <a href="http://nmap.org/book/install.html#inst-svn">here</a>.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F02%2Fnmap-scripts-cleanup%2F&amp;title=Nmap-scripts%20cleanup" id="wpa2a_12"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/02/nmap-scripts-cleanup/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>5 new SNMP scripts in Nmap SVN</title>
		<link>http://www.cqure.net/wp/2010/02/5-new-snmp-scripts-in-nmap-svn/</link>
		<comments>http://www.cqure.net/wp/2010/02/5-new-snmp-scripts-in-nmap-svn/#comments</comments>
		<pubDate>Wed, 17 Feb 2010 11:23:13 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[tools]]></category>
		<category><![CDATA[community]]></category>
		<category><![CDATA[crackin]]></category>
		<category><![CDATA[discovery]]></category>
		<category><![CDATA[hacking]]></category>
		<category><![CDATA[lua]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[public]]></category>
		<category><![CDATA[scanner]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[snmp]]></category>
		<category><![CDATA[subversion]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=348</guid>
		<description><![CDATA[As of yesterday there are now 5 new SNMP scripts in the development release of Nmap. I commited a new ASN.1 library a re-worked SNMP library and 5 new scripts. The new scripts are: snmp-netstat shows listening and connected sockets snmp-processes shows process information including name, pid, path and parameters snmp-win32-services shows the names of [...]]]></description>
			<content:encoded><![CDATA[<p>As of yesterday there are now 5 new SNMP scripts in the development release of Nmap. I commited a new ASN.1 library a re-worked SNMP library and 5 new scripts. The new scripts are:</p>
<ul>
<li>snmp-netstat shows listening and connected sockets</li>
<li>snmp-processes shows process information including name, pid, path and parameters</li>
<li>snmp-win32-services shows the names of running Windows services</li>
<li>snmp-win32-shares shows the names and path of Windows shares</li>
<li>snmp-win32-software shows a list of installed Windows software</li>
<li>snmp-win32-users shows a list of local Windows users</li>
</ul>
<p>Make sure to check them out over at insecure.org. In order to use them you need to check out the development sources from subversion. More info on that over <a href="http://nmap.org/book/install.html#inst-svn">here</a>.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F02%2F5-new-snmp-scripts-in-nmap-svn%2F&amp;title=5%20new%20SNMP%20scripts%20in%20Nmap%20SVN" id="wpa2a_14"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/02/5-new-snmp-scripts-in-nmap-svn/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>nfs-showmount total re-write</title>
		<link>http://www.cqure.net/wp/2010/01/nfs-showmount-total-re-write/</link>
		<comments>http://www.cqure.net/wp/2010/01/nfs-showmount-total-re-write/#comments</comments>
		<pubDate>Mon, 25 Jan 2010 19:44:15 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[tools]]></category>
		<category><![CDATA[detection]]></category>
		<category><![CDATA[discover]]></category>
		<category><![CDATA[discovery]]></category>
		<category><![CDATA[hacking]]></category>
		<category><![CDATA[nfs]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[portscan]]></category>
		<category><![CDATA[scan]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[security]]></category>
		<category><![CDATA[testing]]></category>
		<category><![CDATA[version]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=344</guid>
		<description><![CDATA[I received a bug report for my Nmap nfs-showmount script a few days ago. I ended up re-writing the whole thing as it was my first script, which is short for &#8220;ugly as hell&#8221;. I moved all NFS and RPC stuff into a new library called rpc.lua and added some more functionality as well. I&#8217;ve [...]]]></description>
			<content:encoded><![CDATA[<p>I received a bug report for my Nmap nfs-showmount script a few days ago. I ended up re-writing the whole thing as it was my first script, which is short for &#8220;ugly as hell&#8221;. I moved all NFS and RPC stuff into a new library called rpc.lua and added some more functionality as well.</p>
<p>I&#8217;ve also added two more scripts that make use of the library nfs-get-stats and nfs-get-dirlist. The first retrieves disk usage for each export and the second lists files on a share. They&#8217;re both available from the nmap-scripts <a href="http://www.cqure.net/wp/nmap-scripts/">page</a> as usual.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F01%2Fnfs-showmount-total-re-write%2F&amp;title=nfs-showmount%20total%20re-write" id="wpa2a_16"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/01/nfs-showmount-total-re-write/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Nmap does more MySQL</title>
		<link>http://www.cqure.net/wp/2010/01/nmap-does-more-mysql/</link>
		<comments>http://www.cqure.net/wp/2010/01/nmap-does-more-mysql/#comments</comments>
		<pubDate>Sat, 23 Jan 2010 21:48:44 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[tools]]></category>
		<category><![CDATA[audit]]></category>
		<category><![CDATA[database]]></category>
		<category><![CDATA[detection]]></category>
		<category><![CDATA[discover]]></category>
		<category><![CDATA[discovery]]></category>
		<category><![CDATA[hacking]]></category>
		<category><![CDATA[mysql]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[portscan]]></category>
		<category><![CDATA[query]]></category>
		<category><![CDATA[scan]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[sql]]></category>
		<category><![CDATA[sun]]></category>
		<category><![CDATA[testing]]></category>
		<category><![CDATA[version]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=332</guid>
		<description><![CDATA[I&#8217;ve just added some code to my Nmap MySQL library that enables query support. With this code in place it&#8217;s possible to run queries against MySQL directly from a Nmap script. In order to illustrate this I&#8217;ve added three scripts: mysql-list-users, mysql-list-databases and mysql-show-variables. While messing around with the library I also cleaned up the [...]]]></description>
			<content:encoded><![CDATA[<p>I&#8217;ve just added some code to my Nmap MySQL library that enables query support. With this code in place it&#8217;s possible to run queries against MySQL directly from a Nmap script. In order to illustrate this I&#8217;ve added three scripts: <a href="http://www.cqure.net/wp/nmap-scripts/">mysql-list-users</a>, <a href="http://www.cqure.net/wp/nmap-scripts/">mysql-list-databases</a> and <a href="http://www.cqure.net/wp/nmap-scripts/">mysql-show-variables</a>.</p>
<p>While messing around with the library I also cleaned up the code for <a href="http://www.cqure.net/wp/nmap-scripts/">mysql-brute</a> and <a href="http://www.cqure.net/wp/nmap-scripts/">mysql-empty-password</a>. All of the scripts that query the database obviously require credentials to do so. These can be provided on the command line using script <a href="http://nmap.org/book/nse-usage.html">arguments</a> mysqluser and mysqlpassword or by running the mysql-brute or mysql-empty-password on the same time. There are dependencies set up so that the query scripts wait until these two scripts have collected the credentials. Here&#8217;s some sample output from the scripts &#8230;</p>
<p><span id="more-332"></span>Starting Nmap 5.20 ( http://nmap.org ) at 2010-01-23 22:46 CET<br />
NSE: Starting runlevel 2 (of 2) scan.<br />
NSE: Script Scanning completed.<br />
Nmap scan report for bubba (1.2.3.4)<br />
Host is up (0.0044s latency).<br />
PORT     STATE SERVICE<br />
3306/tcp open  mysql<br />
| mysql-empty-password:<br />
|_  root account has empty password<br />
| mysql-brute:<br />
|   root:&lt;empty&gt; =&gt; Login Correct<br />
|_  test:test =&gt; Login Correct<br />
| mysql-list-users:<br />
|   test<br />
|   root<br />
|   test2<br />
|   album<br />
|   debian-sys-maint<br />
|   horde<br />
|   mediatomb<br />
|_  squeezecenter<br />
| mysql-list-databases:<br />
|   information_schema<br />
|   mysql<br />
|   horde<br />
|   album<br />
|   mediatomb<br />
|_  squeezecenter<br />
| mysql-show-variables:<br />
|   auto_increment_increment: 1<br />
|   auto_increment_offset: 1<br />
|   automatic_sp_privileges: ON<br />
|   back_log: 50<br />
|   basedir: /usr/<br />
|   binlog_cache_size: 32768<br />
|   bulk_insert_buffer_size: 8388608<br />
|   character_set_client: latin1<br />
|   character_set_connection: latin1<br />
|   character_set_database: latin1<br />
|   character_set_filesystem: binary<br />
|   character_set_results: latin1<br />
|   character_set_server: latin1<br />
|   character_set_system: utf8<br />
|   character_sets_dir: /usr/share/mysql/charsets/<br />
|   collation_connection: latin1_swedish_ci<br />
|   collation_database: latin1_swedish_ci<br />
|   collation_server: latin1_swedish_ci<br />
|   completion_type: 0<br />
|   concurrent_insert: 1<br />
|   connect_timeout: 5<br />
|   datadir: /var/lib/mysql/<br />
|   date_format: %Y-%m-%d<br />
|   datetime_format: %Y-%m-%d %H:%i:%s<br />
|   default_week_format: 0<br />
|   delay_key_write: ON<br />
|   delayed_insert_limit: 100<br />
|   delayed_insert_timeout: 300<br />
|   delayed_queue_size: 1000<br />
|   div_precision_increment: 4<br />
|   keep_files_on_create: OFF<br />
|   engine_condition_pushdown: OFF<br />
|   expire_logs_days: 10<br />
|   flush: OFF<br />
|   flush_time: 0<br />
|   ft_boolean_syntax: + -&gt;&lt;()~*:&#8221;"&amp;|<br />
|   ft_max_word_len: 84<br />
|   ft_min_word_len: 4<br />
|   ft_query_expansion_limit: 20<br />
|   ft_stopword_file: (built-in)<br />
|   group_concat_max_len: 1024<br />
|   have_archive: YES<br />
|   have_bdb: NO<br />
|   have_blackhole_engine: YES<br />
|   have_compress: YES<br />
|   have_crypt: YES<br />
|   have_csv: YES<br />
|   have_dynamic_loading: YES<br />
|   have_example_engine: NO<br />
|   have_federated_engine: YES<br />
|   have_geometry: YES<br />
|   have_innodb: DISABLED<br />
|   have_isam: NO<br />
|   have_merge_engine: YES<br />
|   have_ndbcluster: DISABLED<br />
|   have_openssl: DISABLED<br />
|   have_ssl: DISABLED<br />
|   have_query_cache: YES<br />
|   have_raid: NO<br />
|   have_rtree_keys: YES<br />
|   have_symlink: YES<br />
|   hostname: bubba<br />
|   init_connect:<br />
|   init_file:<br />
|   init_slave:<br />
|   innodb_additional_mem_pool_size: 1048576<br />
|   innodb_autoextend_increment: 8<br />
|   innodb_buffer_pool_awe_mem_mb: 0<br />
|   innodb_buffer_pool_size: 8388608<br />
|   innodb_checksums: ON<br />
|   innodb_commit_concurrency: 0<br />
|   innodb_concurrency_tickets: 500<br />
|   innodb_data_file_path:<br />
|   innodb_data_home_dir:<br />
|   innodb_doublewrite: ON<br />
|   innodb_fast_shutdown: 1<br />
|   innodb_file_io_threads: 4<br />
|   innodb_file_per_table: OFF<br />
|   innodb_flush_log_at_trx_commit: 1<br />
|   innodb_flush_method:<br />
|   innodb_force_recovery: 0<br />
|   innodb_lock_wait_timeout: 50<br />
|   innodb_locks_unsafe_for_binlog: OFF<br />
|   innodb_log_arch_dir:<br />
|   innodb_log_archive: OFF<br />
|   innodb_log_buffer_size: 1048576<br />
|   innodb_log_file_size: 5242880<br />
|   innodb_log_files_in_group: 2<br />
|   innodb_log_group_home_dir:<br />
|   innodb_max_dirty_pages_pct: 90<br />
|   innodb_max_purge_lag: 0<br />
|   innodb_mirrored_log_groups: 1<br />
|   innodb_open_files: 300<br />
|   innodb_rollback_on_timeout: OFF<br />
|   innodb_support_xa: ON<br />
|   innodb_sync_spin_loops: 20<br />
|   innodb_table_locks: ON<br />
|   innodb_thread_concurrency: 8<br />
|   innodb_thread_sleep_delay: 10000<br />
|   interactive_timeout: 28800<br />
|   join_buffer_size: 131072<br />
|   key_buffer_size: 16777216<br />
|   key_cache_age_threshold: 300<br />
|   key_cache_block_size: 1024<br />
|   key_cache_division_limit: 100<br />
|   language: /usr/share/mysql/english/<br />
|   large_files_support: ON<br />
|   large_page_size: 0<br />
|   large_pages: OFF<br />
|   lc_time_names: en_US<br />
|   license: GPL<br />
|   local_infile: ON<br />
|   locked_in_memory: OFF<br />
|   log: OFF<br />
|   log_bin: OFF<br />
|   log_bin_trust_function_creators: OFF<br />
|   log_error:<br />
|   log_queries_not_using_indexes: OFF<br />
|   log_slave_updates: OFF<br />
|   log_slow_queries: OFF<br />
|   log_warnings: 1<br />
|   long_query_time: 10<br />
|   low_priority_updates: OFF<br />
|   lower_case_file_system: OFF<br />
|   lower_case_table_names: 0<br />
|   max_allowed_packet: 16776192<br />
|   max_binlog_cache_size: 4294967295<br />
|   max_binlog_size: 104857600<br />
|   max_connect_errors: 10<br />
|   max_connections: 100<br />
|   max_delayed_threads: 20<br />
|   max_error_count: 64<br />
|   max_heap_table_size: 16777216<br />
|   max_insert_delayed_threads: 20<br />
|   max_join_size: 18446744073709551615<br />
|   max_length_for_sort_data: 1024<br />
|   max_prepared_stmt_count: 16382<br />
|   max_relay_log_size: 0<br />
|   max_seeks_for_key: 4294967295<br />
|   max_sort_length: 1024<br />
|   max_sp_recursion_depth: 0<br />
|   max_tmp_tables: 32<br />
|   max_user_connections: 0<br />
|   max_write_lock_count: 4294967295<br />
|   multi_range_count: 256<br />
|   myisam_data_pointer_size: 6<br />
|   myisam_max_sort_file_size: 2147483647<br />
|   myisam_recover_options: BACKUP<br />
|   myisam_repair_threads: 1<br />
|   myisam_sort_buffer_size: 8388608<br />
|   myisam_stats_method: nulls_unequal<br />
|   ndb_autoincrement_prefetch_sz: 32<br />
|   ndb_force_send: ON<br />
|   ndb_use_exact_count: ON<br />
|   ndb_use_transactions: ON<br />
|   ndb_cache_check_time: 0<br />
|   ndb_connectstring:<br />
|   net_buffer_length: 16384<br />
|   net_read_timeout: 30<br />
|   net_retry_count: 10<br />
|   net_write_timeout: 60<br />
|   new: OFF<br />
|   old_passwords: OFF<br />
|   open_files_limit: 1024<br />
|   optimizer_prune_level: 1<br />
|   optimizer_search_depth: 62<br />
|   pid_file: /var/run/mysqld/mysqld.pid<br />
|   port: 3306<br />
|   preload_buffer_size: 32768<br />
|   profiling: OFF<br />
|   profiling_history_size: 15<br />
|   protocol_version: 10<br />
|   query_alloc_block_size: 8192<br />
|   query_cache_limit: 1048576<br />
|   query_cache_min_res_unit: 4096<br />
|   query_cache_size: 16777216<br />
|   query_cache_type: ON<br />
|   query_cache_wlock_invalidate: OFF<br />
|   query_prealloc_size: 8192<br />
|   range_alloc_block_size: 2048<br />
|   read_buffer_size: 131072<br />
|   read_only: OFF<br />
|   read_rnd_buffer_size: 262144<br />
|   relay_log_purge: ON<br />
|   relay_log_space_limit: 0<br />
|   rpl_recovery_rank: 0<br />
|   secure_auth: OFF<br />
|   secure_file_priv:<br />
|   server_id: 0<br />
|   skip_external_locking: ON<br />
|   skip_networking: OFF<br />
|   skip_show_database: OFF<br />
|   slave_compressed_protocol: OFF<br />
|   slave_load_tmpdir: /tmp/<br />
|   slave_net_timeout: 3600<br />
|   slave_skip_errors: OFF<br />
|   slave_transaction_retries: 10<br />
|   slow_launch_time: 2<br />
|   socket: /var/run/mysqld/mysqld.sock<br />
|   sort_buffer_size: 2097144<br />
|   sql_big_selects: ON<br />
|   sql_mode:<br />
|   sql_notes: ON<br />
|   sql_warnings: OFF<br />
|   ssl_ca:<br />
|   ssl_capath:<br />
|   ssl_cert:<br />
|   ssl_cipher:<br />
|   ssl_key:<br />
|   storage_engine: MyISAM<br />
|   sync_binlog: 0<br />
|   sync_frm: ON<br />
|   system_time_zone: CET<br />
|   table_cache: 64<br />
|   table_lock_wait_timeout: 50<br />
|   table_type: MyISAM<br />
|   thread_cache_size: 8<br />
|   thread_stack: 131072<br />
|   time_format: %H:%i:%s<br />
|   time_zone: SYSTEM<br />
|   timed_mutexes: OFF<br />
|   tmp_table_size: 33554432<br />
|   tmpdir: /tmp<br />
|   transaction_alloc_block_size: 8192<br />
|   transaction_prealloc_size: 4096<br />
|   tx_isolation: REPEATABLE-READ<br />
|   updatable_views_with_limit: YES<br />
|   version: 5.0.51a-17~bpo40+1<br />
|   version_comment: (Debian)<br />
|   version_compile_machine: powerpc<br />
|   version_compile_os: debian-linux-gnu<br />
|_  wait_timeout: 28800</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F01%2Fnmap-does-more-mysql%2F&amp;title=Nmap%20does%20more%20MySQL" id="wpa2a_18"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/01/nmap-does-more-mysql/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>New scripts added to Nmap svn</title>
		<link>http://www.cqure.net/wp/2010/01/new-scripts-added-to-nmap-svn/</link>
		<comments>http://www.cqure.net/wp/2010/01/new-scripts-added-to-nmap-svn/#comments</comments>
		<pubDate>Thu, 21 Jan 2010 07:13:06 +0000</pubDate>
		<dc:creator>Patrik Karlsson</dc:creator>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[afp]]></category>
		<category><![CDATA[apple]]></category>
		<category><![CDATA[detection]]></category>
		<category><![CDATA[discover]]></category>
		<category><![CDATA[discovery]]></category>
		<category><![CDATA[dns]]></category>
		<category><![CDATA[filing]]></category>
		<category><![CDATA[hacking]]></category>
		<category><![CDATA[nmap]]></category>
		<category><![CDATA[nse]]></category>
		<category><![CDATA[portscan]]></category>
		<category><![CDATA[protocol]]></category>
		<category><![CDATA[scan]]></category>
		<category><![CDATA[scripts]]></category>
		<category><![CDATA[security]]></category>

		<guid isPermaLink="false">http://www.cqure.net/wp/?p=324</guid>
		<description><![CDATA[Two more scripts of my scripts were added to the development release of nmap, afp-showmount and dns-service-discovery. You can try them out either by downloading them from the nmap-scripts page or by checking out the latest development release over here.]]></description>
			<content:encoded><![CDATA[<p>Two more scripts of my scripts were added to the development release of nmap, <a href="http://www.cqure.net/wp/nmap-scripts/">afp-showmount</a> and <a href="http://www.cqure.net/wp/nmap-scripts/">dns-service-discovery</a>. You can try them out either by downloading them from the nmap-scripts <a href="http://www.cqure.net/wp/nmap-scripts/">page</a> or by checking out the latest development release over <a href="http://nmap.org/book/install.html#inst-svn">here</a>.</p>
<p><a class="a2a_dd a2a_target addtoany_share_save" href="http://www.addtoany.com/share_save#url=http%3A%2F%2Fwww.cqure.net%2Fwp%2F2010%2F01%2Fnew-scripts-added-to-nmap-svn%2F&amp;title=New%20scripts%20added%20to%20Nmap%20svn" id="wpa2a_20"><img src="http://www.cqure.net/wp/wp-content/plugins/add-to-any/share_save_171_16.png" width="171" height="16" alt="Share"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://www.cqure.net/wp/2010/01/new-scripts-added-to-nmap-svn/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
